<!DOCTYPE html>
<html lang=zh>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="BackgroundPreviously we’ve seen how to handle the click event inside component. We just need to do: In onCreateLayout, attach an .clickHandler and pass in the implementation of the event handler that">
<meta name="keywords" content="componets">
<meta property="og:type" content="article">
<meta property="og:title" content="Events of Components">
<meta property="og:url" content="http://yoursite.com/2018/02/05/11-Events-of-Components/index.html">
<meta property="og:site_name" content="走路草的博客">
<meta property="og:description" content="BackgroundPreviously we’ve seen how to handle the click event inside component. We just need to do: In onCreateLayout, attach an .clickHandler and pass in the implementation of the event handler that">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2018-02-06T16:46:31.728Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Events of Components">
<meta name="twitter:description" content="BackgroundPreviously we’ve seen how to handle the click event inside component. We just need to do: In onCreateLayout, attach an .clickHandler and pass in the implementation of the event handler that">
    
    
        
          
              <link rel="shortcut icon" href="/images/favicon.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
          
        
    
    <!-- title -->
    <title>Events of Components</title>
    <!-- styles -->
    <link rel="stylesheet" href="/css/style.css">
    <!-- rss -->
    
    
</head>

<body>
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="http://github.com/probberechts">Projects</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/2018/03/11/12-Catch-Up-From-Vacation/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="/2018/01/28/10_State_Of_Component/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://yoursite.com/2018/02/05/11-Events-of-Components/"><i class="fa fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://yoursite.com/2018/02/05/11-Events-of-Components/&text=Events of Components"><i class="fa fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://yoursite.com/2018/02/05/11-Events-of-Components/&title=Events of Components"><i class="fa fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://yoursite.com/2018/02/05/11-Events-of-Components/&is_video=false&description=Events of Components"><i class="fa fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Events of Components&body=Check out this article: http://yoursite.com/2018/02/05/11-Events-of-Components/"><i class="fa fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://yoursite.com/2018/02/05/11-Events-of-Components/&title=Events of Components"><i class="fa fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://yoursite.com/2018/02/05/11-Events-of-Components/&title=Events of Components"><i class="fa fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://yoursite.com/2018/02/05/11-Events-of-Components/&title=Events of Components"><i class="fa fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://yoursite.com/2018/02/05/11-Events-of-Components/&title=Events of Components"><i class="fa fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://yoursite.com/2018/02/05/11-Events-of-Components/&name=Events of Components&description="><i class="fa fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Background"><span class="toc-number">1.</span> <span class="toc-text">Background</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Step-1-Declare-Your-Custom-Event"><span class="toc-number">2.</span> <span class="toc-text">Step 1: Declare Your Custom Event</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Step-2-Dispatch-Event"><span class="toc-number">3.</span> <span class="toc-text">Step 2: Dispatch Event</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Step-3-Handle-Event"><span class="toc-number">4.</span> <span class="toc-text">Step 3: Handle Event</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Also-Notice"><span class="toc-number">5.</span> <span class="toc-text">Also Notice</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Future-Work"><span class="toc-number">6.</span> <span class="toc-text">Future Work</span></a></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index width mx-auto px2 my4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        Events of Components
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">走路草的博客</span>
      </span>
      
    <div class="postdate">
        <time datetime="2018-02-06T04:36:08.000Z" itemprop="datePublished">2018-02-05</time>
    </div>


      
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/tags/componets/">componets</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <h2 id="Background"><a href="#Background" class="headerlink" title="Background"></a>Background</h2><p>Previously we’ve seen how to handle the click event inside component. We just need to do: In onCreateLayout, attach an <code>.clickHandler</code> and pass in the implementation of the event handler that is defined in the same file. This is straightforward. However, how to dispatch your own event from root component and handle it somewhere deep inside a child component?</p>
<h2 id="Step-1-Declare-Your-Custom-Event"><a href="#Step-1-Declare-Your-Custom-Event" class="headerlink" title="Step 1: Declare Your Custom Event"></a>Step 1: Declare Your Custom Event</h2><p>The event need to be in a separate file rather than the LayoutSpec or MountSpec. The reason is LayoutSpec and MountSpec are private concept but the Event should be public concept that can be passed around multiple classes. </p>
<pre><code>@Event
public class ColorChangedEvent {
  public int color;
}
</code></pre><h2 id="Step-2-Dispatch-Event"><a href="#Step-2-Dispatch-Event" class="headerlink" title="Step 2: Dispatch Event"></a>Step 2: Dispatch Event</h2><p>When dispatching your custom event from child component and pass it up all the way to some parent, you need to annotate all the spec along the way with this event so that the framework knows that it will dispatch it. Also it needs a handler to be passed in as a @Prop.</p>
<pre><code>@LayoutSpec(events = { ColorChangedEvent.class })  // Annotate this event so that framework knows it&apos;s going to dispatch this event.
class ColorComponentSpec {
  ...
  @OnCreateLayout
  static Component onCreateLayout(
      Context c,
      @Prop EventHandler colorChangedHandler,  // Need a handler as a Prop. Similiar to event listener callback interface. 
      @Prop int color) {
    ...
    ColorComponent.dispatchColorChangedEvent( // Dispatch this event with the handler and the event attributes values. 
        colorChangedHandler,
        color);
    ...
  }
}
</code></pre><h2 id="Step-3-Handle-Event"><a href="#Step-3-Handle-Event" class="headerlink" title="Step 3: Handle Event"></a>Step 3: Handle Event</h2><p>The handler instance: Use @OnEvent(ColorChangedEvent.class) to define.<br>The handler callback: Generated by framework, and has the same name as your handler.     </p>
<p>In parent: define the callback and pass it down into child. So that in child when it needs to further dispatch it can get a handler. </p>
<pre><code>@LayoutSpec
class MyComponentSpec {

  @OnCreateLayout
  static Component onCreateLayout(
      LayoutContext c,
      @Prop String someColor) {

    return Column.create(c)
        ...
        .child(
            ColorComponent.create(c)
                .color(someColor)
                .colorChangedHandler(MyComponent.onColorChanged(c))
        ...
        .build();

  }

  @OnEvent(ColorChangedEvent.class)
  static void onColorChanged(
      ComponentContext c,
      @FromEvent int color,
      @Prop String someProp) {
    Log.d(&quot;MyComponent&quot;, &quot;Color changed: &quot; + color);
  }
}
</code></pre><h2 id="Also-Notice"><a href="#Also-Notice" class="headerlink" title="Also Notice"></a>Also Notice</h2><p>In your event handler, you can use the normal @Prop just like other methods. You can also use @Param to pass in dynamic values. E.g., when a facepile is clicked, you want to know which face is clicked when handling it.</p>
<p>逻辑上来讲， Event dispatch是由内而外的传递，而实际上写的时候是把Handler由外而内一层层传递进去。</p>
<h2 id="Future-Work"><a href="#Future-Work" class="headerlink" title="Future Work"></a>Future Work</h2><p>There might also be use cases where you need to pass an event down from the parent component to child and handle it in child. In that case, use Trigger API.</p>

  </div>
</article>



    </div>
    
      <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="http://github.com/probberechts">Projects</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Background"><span class="toc-number">1.</span> <span class="toc-text">Background</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Step-1-Declare-Your-Custom-Event"><span class="toc-number">2.</span> <span class="toc-text">Step 1: Declare Your Custom Event</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Step-2-Dispatch-Event"><span class="toc-number">3.</span> <span class="toc-text">Step 2: Dispatch Event</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Step-3-Handle-Event"><span class="toc-number">4.</span> <span class="toc-text">Step 3: Handle Event</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Also-Notice"><span class="toc-number">5.</span> <span class="toc-text">Also Notice</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Future-Work"><span class="toc-number">6.</span> <span class="toc-text">Future Work</span></a></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://yoursite.com/2018/02/05/11-Events-of-Components/"><i class="fa fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://yoursite.com/2018/02/05/11-Events-of-Components/&text=Events of Components"><i class="fa fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://yoursite.com/2018/02/05/11-Events-of-Components/&title=Events of Components"><i class="fa fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://yoursite.com/2018/02/05/11-Events-of-Components/&is_video=false&description=Events of Components"><i class="fa fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Events of Components&body=Check out this article: http://yoursite.com/2018/02/05/11-Events-of-Components/"><i class="fa fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://yoursite.com/2018/02/05/11-Events-of-Components/&title=Events of Components"><i class="fa fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://yoursite.com/2018/02/05/11-Events-of-Components/&title=Events of Components"><i class="fa fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://yoursite.com/2018/02/05/11-Events-of-Components/&title=Events of Components"><i class="fa fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://yoursite.com/2018/02/05/11-Events-of-Components/&title=Events of Components"><i class="fa fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://yoursite.com/2018/02/05/11-Events-of-Components/&name=Events of Components&description="><i class="fa fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
      <ul>
        <li id="toc"><a class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa fa-list fa-lg" aria-hidden="true"></i> TOC</a></li>
        <li id="share"><a class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa fa-share-alt fa-lg" aria-hidden="true"></i> Share</a></li>
        <li id="top" style="display:none"><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a></li>
        <li id="menu"><a class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa fa-bars fa-lg" aria-hidden="true"></i> Menu</a></li>
      </ul>
    </div>

  </div>
</div>

    
    <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2018 走路草
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="http://github.com/probberechts">Projects</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

</body>
</html>
<!-- styles -->
<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">
<link rel="stylesheet" href="/lib/meslo-LG/styles.css">
<link rel="stylesheet" href="/lib/justified-gallery/justifiedGallery.min.css">

<!-- jquery -->
<script src="/lib/jquery/jquery.min.js"></script>
<script src="/lib/justified-gallery/jquery.justifiedGallery.min.js"></script>
<script src="/js/main.js"></script>
<!-- search -->

<!-- Google Analytics -->

    <script type="text/javascript">
        (function(i,s,o,g,r,a,m) {i['GoogleAnalyticsObject']=r;i[r]=i[r]||function() {
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-86660611-1', 'auto');
        ga('send', 'pageview');
    </script>

<!-- Disqus Comments -->


